"use strict";var e,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,a={};((e,n)=>{for(var s in n)t(e,s,{get:n[s],enumerable:!0})})(a,{PolarEmbedCheckout:()=>r}),module.exports=(e=a,((e,a,i,r)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let d of s(a))o.call(e,d)||d===i||t(e,d,{get:()=>a[d],enumerable:!(r=n(a,d))||r.enumerable});return e})(t({},"__esModule",{value:!0}),e));var i="POLAR_CHECKOUT",r=class e{iframe;loader;loaded;closable;eventTarget;windowMessageListener;constructor(e,t){this.iframe=e,this.loader=t,this.loaded=!1,this.closable=!0,this.eventTarget=new EventTarget,this.windowMessageListener=this.handleWindowMessage.bind(this),window.addEventListener("message",this.windowMessageListener),this.addEventListener("loaded",this.loadedListener.bind(this)),this.addEventListener("close",this.closeListener.bind(this)),this.addEventListener("confirmed",this.confirmedListener.bind(this)),this.addEventListener("success",this.successListener.bind(this))}static postMessage(e,t){window.parent.postMessage({...e,type:i},t)}static async create(t,n){"string"==typeof n&&(console.warn(`Passing theme as string is deprecated. Use { theme: "${n}" } instead.`),n={theme:n});const s=document.createElement("style");s.innerText=`\n      .polar-loader-spinner {\n        width: 20px;\n        aspect-ratio: 1;\n        border-radius: 50%;\n        background: ${"dark"===n?.theme?"#000":"#fff"};\n        box-shadow: 0 0 0 0 ${"dark"===n?.theme?"#fff":"#000"};\n        animation: polar-loader-spinner-animation 1s infinite;\n      }\n      @keyframes polar-loader-spinner-animation {\n        100% {box-shadow: 0 0 0 30px #0000}\n      }\n      body.polar-no-scroll {\n        overflow: hidden;\n      }\n    `,document.head.appendChild(s);const o=document.createElement("div");o.style.position="absolute",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.zIndex="2147483647",o.style.colorScheme="auto";const a=document.createElement("div");a.className="polar-loader-spinner",o.appendChild(a),document.body.classList.add("polar-no-scroll"),document.body.appendChild(o);const i=new URL(t);i.searchParams.set("embed","true"),i.searchParams.set("embed_origin",window.location.origin),n?.theme&&i.searchParams.set("theme",n.theme);const r=i.toString(),d=document.createElement("iframe");d.src=r,d.style.position="fixed",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%",d.style.border="none",d.style.zIndex="2147483647",d.style.backgroundColor="rgba(0, 0, 0, 0.5)",d.style.colorScheme="auto";const l="https://polar.sh,https://sandbox.polar.sh".split(",").join(" ");d.allow=`payment 'self' ${l}; publickey-credentials-get 'self' ${l};`,document.body.appendChild(d);const c=new e(d,o);return n?.onLoaded&&c.addEventListener("loaded",n.onLoaded,{once:!0}),new Promise(e=>{c.addEventListener("loaded",()=>e(c),{once:!0})})}static init(){document.querySelectorAll("[data-polar-checkout]").forEach(t=>{t.removeEventListener("click",e.checkoutElementClickHandler),t.addEventListener("click",e.checkoutElementClickHandler)})}close(){window.removeEventListener("message",this.windowMessageListener),document.body.contains(this.iframe)&&document.body.removeChild(this.iframe),document.body.classList.remove("polar-no-scroll")}addEventListener(e,t,n){this.eventTarget.addEventListener(e,t,n)}removeEventListener(e,t){this.eventTarget.removeEventListener(e,t)}static async checkoutElementClickHandler(t){t.preventDefault();let n=t.target;for(;!n.hasAttribute("data-polar-checkout");){if(!n.parentElement)return;n=n.parentElement}const s=n.getAttribute("href")||n.getAttribute("data-polar-checkout"),o=n.getAttribute("data-polar-checkout-theme");e.create(s,o?{theme:o}:void 0)}loadedListener(e){e.defaultPrevented||this.loaded||(document.body.removeChild(this.loader),this.loaded=!0)}closeListener(e){e.defaultPrevented||this.closable&&this.close()}confirmedListener(e){e.defaultPrevented||(this.closable=!1)}successListener(e){e.defaultPrevented||(this.closable=!0,e.detail.redirect&&(window.location.href=e.detail.successURL))}handleWindowMessage({data:e,origin:t}){"https://polar.sh,https://sandbox.polar.sh".split(",").includes(t)&&(e.type===i&&this.eventTarget.dispatchEvent(new CustomEvent(e.event,{detail:e,cancelable:!0})))}};if("undefined"!=typeof window&&(window.Polar={EmbedCheckout:r}),"undefined"!=typeof document){const e=document.currentScript;e&&e.hasAttribute("data-auto-init")&&document.addEventListener("DOMContentLoaded",async()=>{r.init()})}